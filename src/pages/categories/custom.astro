---
const events = [
  {
    title: "AWS re:Invent 2025",
    date: "December 01-05, 2025",
    location: "Las Vegas, NV",
    img: "https://cdn.thenewstack.io/media/2024/12/fc08cf7f-aws-reinvent.png",
  },
  {
    title: "KubeCon + CloudNativeCon NA 2025",
    date: "November 10-13, 2025",
    location: "Atlanta, GA",
    img: "https://cdn.thenewstack.io/media/2024/12/9d72bd62-calendar_kubecon_na25_10-13.11.2025_atl_1x1.png",
  },
  {
    title: "CloudFest USA",
    date: "November 05-06, 2025",
    location: "Miami, FL @ Ice Palace Studios",
    img: "https://cdn.thenewstack.io/media/2025/02/d89b5f33-new-stack-web-banner-600x600-1.png",
  },
  {
    title: "All Things Open 2025",
    date: "October 12-14, 2025",
    location: "Raleigh, NC @ Raleigh Convention Center",
    img: "https://cdn.thenewstack.io/media/2024/12/ccfb4848-calendar_ato25_12-14.10.2025_raleigh_1x1.png",
  },
  {
    title: "DevOps World 2025",
    date: "September 16-19, 2025",
    location: "Las Vegas, NV @ Caesars Palace",
    img: "https://cdn.thenewstack.io/media/2025/08/8d1e6656-mirantis_event_rancher-at-end.jpg",
  },
  {
    title: "KubeCon + CloudNativeCon EU 2025",
    date: "April 15-18, 2025",
    location: "Barcelona, Spain",
    img: "https://cdn.thenewstack.io/media/2025/08/1ed6afcf-iacconf_event.png",
  }
];
---
<section class="w-full py-10 bg-gradient-to-r from-pink-500 to-red-500 text-white">
  <h2 class="text-2xl font-bold mb-6 text-center">EVENTS</h2>

  <div class="relative container mx-auto">
    <div class="overflow-hidden">
      <div id="slider" class="flex transition-transform duration-500 ease-in-out">
        <!-- Clone cuối (prepend) -->
        {events.slice(-4).map((event) => (
          <div class="w-1/4 p-2 flex-shrink-0">
            <div class="bg-white text-black rounded-xl shadow-lg overflow-hidden">
              <img src={event.img} alt={event.title} class="w-full h-40 object-cover" />
              <div class="p-3">
                <h3 class="font-bold text-sm">{event.title}</h3>
                <p class="font-semibold text-xs">{event.date}</p>
                <p class="text-xs">{event.location}</p>
              </div>
            </div>
          </div>
        ))}

        <!-- Slide thật -->
        {events.map((event) => (
          <div class="w-1/4 p-2 flex-shrink-0">
            <div class="bg-white text-black rounded-xl shadow-lg overflow-hidden">
              <img src={event.img} alt={event.title} class="w-full h-40 object-cover" />
              <div class="p-3">
                <h3 class="font-bold text-sm">{event.title}</h3>
                <p class="font-semibold text-xs">{event.date}</p>
                <p class="text-xs">{event.location}</p>
              </div>
            </div>
          </div>
        ))}

        <!-- Clone đầu (append) -->
        {events.slice(0, 4).map((event) => (
          <div class="w-1/4 p-2 flex-shrink-0">
            <div class="bg-white text-black rounded-xl shadow-lg overflow-hidden">
              <img src={event.img} alt={event.title} class="w-full h-40 object-cover" />
              <div class="p-3">
                <h3 class="font-bold text-sm">{event.title}</h3>
                <p class="font-semibold text-xs">{event.date}</p>
                <p class="text-xs">{event.location}</p>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Nút điều hướng -->
    <button id="prevBtn" class="btn btn-circle absolute left-0 top-1/2 -translate-y-1/2">❮</button>
    <button id="nextBtn" class="btn btn-circle absolute right-0 top-1/2 -translate-y-1/2">❯</button>
  </div>
</section>

<script>
const slider = document.getElementById("slider");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

const totalItems = slider.children.length; // bao gồm clone
const itemsPerPage = 4;
let currentIndex = 4; // bắt đầu từ item thật đầu tiên (sau clone prepend)
const maxIndex = totalItems - 4; // điểm xa nhất trước khi reset

function updateSlider(animate = true) {
  if (!animate) {
    slider.style.transition = "none";
  } else {
    slider.style.transition = "transform 0.5s ease-in-out";
  }
  slider.style.transform = `translateX(-${currentIndex * 25}%)`;
}

updateSlider(false);

// Next
nextBtn.addEventListener("click", () => {
  currentIndex++;
  updateSlider(true);
});

// Prev
prevBtn.addEventListener("click", () => {
  currentIndex--;
  updateSlider(true);
});

// Reset khi tới clone
slider.addEventListener("transitionend", () => {
  if (currentIndex >= totalItems - itemsPerPage) {
    // sang clone đầu -> reset về item thật đầu
    currentIndex = 4;
    updateSlider(false);
  }
  if (currentIndex <= 0) {
    // sang clone cuối -> reset về item thật cuối
    currentIndex = totalItems - itemsPerPage - 1;
    updateSlider(false);
  }
});
</script>



